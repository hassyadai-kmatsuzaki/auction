# メダカライブオークションシステム - 仕様書

## 📚 ドキュメント一覧

本システムの仕様書は以下の6つのドキュメントで構成されています。

### 1. [システム概要](./01_システム概要.md)
システム全体の概要、特徴、ユーザー種別、主要機能一覧を記載しています。

**主な内容:**
- システムの特徴（リアルタイム入札、6レーン同時進行）
- ユーザー種別（管理者、参加者）
- オークションスケジュール
- プレミアムプラン
- **車や絵画のオークション会場のようなライブ感**

---

### 2. [画面設計](./02_画面設計.md)
全17画面の詳細仕様と画面遷移図を記載しています。

**主な内容:**
- 共通画面（ログイン、登録申請）
- 参加者向け画面（お知らせ一覧、オークション会場、落札管理）
- 管理者向け画面（ダッシュボード、お知らせ管理、オークション管理、生体管理、ライブ管理、落札者管理、ユーザー管理、設定）
- 画面遷移図
- レスポンシブデザイン要件

**参考UI:** [メダカライブオークション](https://v0-medaka-auction-ui.vercel.app/)

---

### 3. [データベース設計](./03_データベース設計.md)
全11テーブルのER図とテーブル定義を記載しています。

**主なテーブル:**
- `users`: ユーザー（承認制）
- `auctions`: オークションイベント
- `items`: 生体（商品）
- `item_media`: 生体メディア（動画・画像）
- `lanes`: レーン
- `lane_items`: レーン商品割り当て
- `bids`: 入札
- `won_items`: 落札
- `announcements`: お知らせ
- `announcement_reads`: お知らせ既読管理
- `system_settings`: システム設定

---

### 4. [API設計](./04_API設計.md)
RESTful APIの仕様とWebSocketイベントを記載しています。

**主なAPI:**
- 認証API（登録申請、ログイン、ログアウト）
- お知らせAPI
- オークションAPI
- リアルタイム入札API
- 落札API
- 管理者API（お知らせ管理、オークション管理、生体管理、ライブ管理、落札者管理、ユーザー管理、設定）

**WebSocketイベント:**
- `PriceUpdated`: 価格更新
- `LaneChanged`: レーン切替
- `BidderJoined`: 入札者参加
- `BidderLeft`: 入札者離脱

---

### 5. [ビジネスフロー](./05_ビジネスフロー.md)
システムの業務フローを詳細に記載しています。

**主なフロー:**
1. **ユーザー登録・承認フロー**: 登録申請 → 管理者承認 → ログイン可能
2. **お知らせ配信フロー**: 作成 → 配信 → 閲覧
3. **オークション準備フロー**: オークション作成 → 生体登録 → レーン割り当て → 開催前通知
4. **オークション開催フロー**: 開始 → リアルタイム入札 → 落札決定 → 進行制御
5. **落札後フロー**: 落札通知 → 振込 → 発送
6. **システム設定フロー**: 各種設定の変更
7. **トラブル対応フロー**: 緊急停止、入金遅延

---

### 6. [技術仕様](./06_技術仕様.md)
開発に必要な技術的な詳細を記載しています。

**主な内容:**
- 技術スタック（TypeScript/React/MUI、Laravel、MySQL）
- ディレクトリ構成
- リアルタイム入札の実装
- 価格上昇ロジック
- パフォーマンス最適化
- セキュリティ対策
- テスト戦略
- デプロイ手順

---

## 🎯 必要ページまとめ

### 共通（2ページ）
1. ログイン
2. ユーザー登録申請

### 参加者向け（3ページ）
1. お知らせ一覧（ホーム）
2. オークション会場（6レーン）
3. 落札管理

### 管理者向け（12ページ）
1. 管理ダッシュボード
2. お知らせ管理
3. お知らせ作成・編集
4. オークション管理
5. オークション作成・編集
6. 生体管理（商品管理）
7. 生体登録・編集
8. ライブオークション管理（6レーン制御）
9. 落札者管理
10. ユーザー管理
11. ユーザー詳細・編集
12. 設定

**合計: 17ページ**

---

## 📊 データベース構成まとめ

### コアテーブル（11テーブル）
1. **users**: ユーザー管理（承認制）
2. **auctions**: オークションイベント管理
3. **items**: 生体（商品）管理
4. **item_media**: 動画・画像管理
5. **lanes**: レーン管理
6. **lane_items**: レーン商品割り当て
7. **bids**: 入札管理
8. **won_items**: 落札管理
9. **announcements**: お知らせ管理
10. **announcement_reads**: お知らせ既読管理
11. **system_settings**: システム設定

### リレーション
```
users (1) ──< (N) bids
users (1) ──< (N) won_items

auctions (1) ──< (N) items
auctions (1) ──< (N) lanes

items (1) ──< (N) item_media
items (1) ──< (N) bids
items (1) ──< (1) won_items

lanes (1) ──< (N) lane_items

announcements (1) ──< (N) announcement_reads
```

---

## 🚀 開発の進め方

### Phase 1: 基盤構築（Week 1-2）
- [ ] データベース設計・マイグレーション
- [ ] ユーザー認証機能（承認制）
- [ ] 基本的なCRUD（ユーザー、オークション、生体）
- [ ] 管理画面の基礎

### Phase 2: コア機能（Week 3-4）
- [ ] 生体登録・表示機能
- [ ] 動画・画像アップロード
- [ ] オークションイベント管理
- [ ] お知らせ管理機能
- [ ] 参加者のホーム画面

### Phase 3: リアルタイム機能（Week 5-7）
- [ ] WebSocket環境構築（Laravel Echo + Pusher）
- [ ] 6レーンのリアルタイム入札UI
- [ ] 入札ロジック実装
- [ ] 価格自動上昇システム
- [ ] レーン進行制御

### Phase 4: 落札管理（Week 8-9）
- [ ] 落札管理機能
- [ ] 振込確認機能
- [ ] 発送管理機能
- [ ] 請求書生成

### Phase 5: テスト・デプロイ（Week 10）
- [ ] ユニットテスト
- [ ] E2Eテスト
- [ ] パフォーマンステスト
- [ ] 本番環境デプロイ

---

## 📝 重要な変更点（v2.0）

### ✅ 追加された機能
- **ユーザー承認制**: 参加者は管理者の承認が必要
- **お知らせ機能**: 管理者からの通知配信
- **システム設定**: 価格上昇率などを管理画面から変更可能

### ❌ 削除された機能
以下の機能は、**リアルタイムオークション会場のコンセプトに合わないため削除**：

- お気に入り機能（事前登録・通知）
- 商品の事前一覧・詳細閲覧
- 出品者機能（すべて管理者が管理）
- 保証金システム
- 受取方法の詳細選択（配送のみに簡素化）

### 🎯 コンセプト
**車や絵画のオークション会場のような、その場で進行するライブオークション**
- 事前閲覧なし
- お気に入り登録なし
- オークション当日のみ、6レーンで同時進行

---

## 📞 関連リンク

- **参考UI**: [メダカライブオークション](https://v0-medaka-auction-ui.vercel.app/)
- **開発環境**: Docker Compose
- **ポート**: 8430 (Nginx)、23306 (MySQL)

---

## 🔖 バージョン履歴

- **v2.0** (2025-11-12): 大幅リニューアル
  - リアルタイムオークション会場のコンセプトに変更
  - お気に入り機能削除
  - 出品者機能削除（管理者が一括管理）
  - ユーザー承認制導入
  - お知らせ機能追加
  - ページ数を17画面に簡素化

- **v1.0** (2025-11-12): 初版作成
  - システム概要、画面設計、DB設計、API設計、ビジネスフロー、技術仕様を作成
